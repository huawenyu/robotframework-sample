*** Settings ***
Library           OperatingSystem
Library           lib-remote/MyRemote.py

*** Test Cases ***
My Test
    Log         ${EXECDIR}
    Sendline    vm-cache   get system status

    # set implicit policy
    ${firewall_pol}=  catenate  SEPARATOR='\n'
    ...  config firewall pol
    ...  edit 3
    ...      set srcintf "port2"
    ...      set dstintf "port1"
    ...      set srcaddr "all"
    ...      set dstaddr "all"
    ...      set action accept
    ...      set schedule "always"
    ...      set service "ALL"
    ...      set utm-status enable
    ...      set logtraffic all
    ...      set logtraffic-start enable
    ...      set log-http-transaction enable
    ...      set webcache enable
    ...      set webcache-https any
    ...      set webproxy-profile "add-xforw"
    ...      set profile-protocol-options "default"
    ...      set ssl-ssh-profile "deep-inspection"
    ...      set nat enable
    ...  next
    ...  end
    Sendline    vm-cache    ${firewall_pol}

    # request from PC.curl
    ${port2} =          Get Config     vm-cache         port2
    Sendline        linux-1    sudo ip route change default via ${port2}
    Flush           linux-1
    Sendline        linux-1    curl www.tired.com
    Expect String   linux-1    Are you tired?

